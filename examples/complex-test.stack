{
  @[ar ai br bi] !2
  ar br * ai bi * - 
  ar bi * ai br * +
} @cmul

{
  @[ar ai br bi] !2
  ar br +
  ai bi +
} @cadd

{
  @[r i] !0
  r write 
  "+" write
  i write
  "i" write
} @cwrite

"multiply:" writeln
"actual: " write 3 -2 4 5 cmul cwrite newline
"expect: " write 22 7 cwrite newline
newline

"add:" writeln
"actual: " write 3 -2 4 5 cadd cwrite newline
"expect: " write 7 3 cwrite newline